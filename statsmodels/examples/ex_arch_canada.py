"""

Created on Sat Dec 24 07:31:47 2011

Author: Josef Perktold
"""
import numpy as np
import statsmodels.stats.diagnostic as dia
canada_raw = '     405.36646642737\t    929.610513893698\t    7.52999999999884\t    386.136109062605\n    404.639833965913\t    929.803984550587\t    7.69999999999709\t    388.135759111711\n    403.814883043744\t    930.318387567177\t    7.47000000000116\t    390.540112911955\n    404.215773188006\t    931.427687420772\t     7.2699999999968\t    393.963817246136\n    405.046713585284\t    932.662005594273\t    7.37000000000262\t    396.764690917547\n    404.416738673847\t    933.550939726636\t    7.12999999999738\t    400.021701616327\n     402.81912737043\t    933.531526191785\t    7.40000000000146\t    400.751498688807\n    401.977334663103\t    933.076879439814\t    8.33000000000175\t    405.733473658807\n    402.089724946428\t     932.12375320915\t    8.83000000000175\t     409.05038628366\n    401.306688373207\t    930.635939140315\t     10.429999999993\t    411.398377747425\n    401.630171263522\t    929.097059933419\t    12.1999999999971\t    413.019421511595\n     401.56375463175\t    928.563335601161\t    12.7700000000041\t    415.166962884156\n    402.815698906973\t    929.069380060201\t     12.429999999993\t    414.662070678749\n    403.142107624713\t    930.265516098198\t    12.2299999999959\t    415.731936138368\n    403.078619166324\t    931.677031559203\t    11.6999999999971\t    416.231468866173\n    403.718785733801\t    932.138967575148\t    11.1999999999971\t     418.14392690728\n    404.866799027579\t    932.276686471608\t    11.2700000000041\t    419.735231229658\n    405.636186735378\t    932.832783118083\t    11.4700000000012\t    420.484186198549\n    405.136285378794\t    933.733419116009\t    11.3000000000029\t    420.930881402259\n    406.024639922986\t    934.177206176622\t    11.1699999999983\t    422.112404525291\n    406.412269729241\t    934.592839827856\t                  11\t    423.627805811063\n    406.300932644569\t    935.606709830033\t    10.6300000000047\t    423.988686751336\n    406.335351723382\t    936.511085968336\t    10.2700000000041\t    424.190212657915\n    406.773695329549\t    937.420090112655\t    10.1999999999971\t    426.127043353785\n    405.152547649247\t    938.415921627889\t    9.66999999999825\t    426.857794216679\n    404.929830809648\t    938.999170021426\t    9.60000000000582\t    426.745717993024\n    404.576546350926\t    939.235354789206\t    9.60000000000582\t    426.885793656802\n    404.199492630983\t    939.679504234357\t                 9.5\t    428.840253264144\n     405.94985619596\t    940.249674139969\t                 9.5\t    430.122322107039\n     405.82209202516\t    941.435818685214\t    9.02999999999884\t    430.230679154048\n    406.446282537108\t     942.29809597644\t    8.69999999999709\t    430.392994893689\n    407.051247525876\t    943.532223256403\t    8.13000000000466\t    432.028420083791\n    407.946023990985\t     944.34896981513\t    7.87000000000262\t    433.388625934544\n    408.179584663105\t    944.821488789039\t    7.66999999999825\t    433.964091817787\n    408.599812740441\t    945.067136927327\t    7.80000000000291\t    434.484384354647\n    409.090560656008\t     945.80672616174\t     7.7300000000032\t    436.156879277168\n    408.704215141145\t    946.869661504613\t    7.56999999999971\t    438.265143944308\n    408.980275213206\t    946.876612143542\t    7.56999999999971\t    438.763587343863\n    408.328690037174\t    947.249692256472\t    7.33000000000175\t    439.949811558539\n    407.885696563307\t    947.651276093962\t    7.56999999999971\t    441.835856392131\n    407.260532233258\t    948.183970741596\t    7.62999999999738\t    443.176872656863\n    406.775150765526\t    948.349239264364\t    7.59999999999854\t    444.359199033223\n    406.179413590339\t    948.032170661406\t    8.16999999999825\t    444.523614807208\n    405.439793348166\t    947.106483115935\t    9.19999999999709\t    446.969404642587\n    403.279970790458\t    946.079554231134\t    10.1699999999983\t    450.158586973168\n    403.364855995771\t    946.183811678692\t    10.3300000000017\t    451.546427290378\n    403.380680430043\t     946.22579516585\t    10.3999999999942\t    452.298351499968\n    404.003182812546\t    945.997783938785\t    10.3699999999953\t    453.120066578834\n     404.47739841708\t    945.518279080208\t    10.6000000000058\t    453.999145996277\n    404.786782762866\t    945.351397570438\t                  11\t    454.955176222477\n    405.271003921828\t    945.291785517556\t    11.3999999999942\t    455.482381155116\n    405.382993140508\t    945.400785900878\t    11.7299999999959\t    456.100929020225\n    405.156416006566\t    945.905809840959\t     11.070000000007\t    457.202696739531\n    406.470043094757\t     945.90347041344\t    11.6699999999983\t    457.388589594786\n    406.229308967752\t    946.319028746014\t    11.4700000000012\t    457.779898919191\n    406.726483850871\t    946.579621275764\t    11.3000000000029\t    457.553538085846\n    408.578504884277\t    946.780032223884\t    10.9700000000012\t     458.80240271533\n     409.67671010704\t    947.628284240641\t    10.6300000000047\t     459.05640335985\n    410.385763295936\t    948.622057553611\t    10.1000000000058\t     459.15782324686\n    410.539523677181\t    949.399183241404\t    9.66999999999825\t    459.703720275789\n    410.445258303139\t    949.948137966398\t    9.52999999999884\t    459.703720275789\n    410.625605270832\t    949.794494142446\t    9.47000000000116\t    460.025814162716\n    410.867239714014\t    949.953380175189\t                 9.5\t    461.025722503696\n    411.235917829196\t    950.250239444989\t    9.27000000000407\t     461.30391443673\n    410.663655285725\t    950.538030883093\t                 9.5\t      461.4030814421\n    410.808508412624\t    950.787128498243\t    9.42999999999302\t    462.927726133156\n    412.115961520089\t    950.869528648471\t    9.69999999999709\t    464.688777934061\n    412.999407129539\t    950.928132469716\t    9.89999999999418\t    465.071700094375\n    412.955056755303\t    951.845722481401\t    9.42999999999302\t    464.285125295526\n     412.82413309368\t      952.6004761952\t    9.30000000000291\t    464.034426099541\n       413.048874899\t    953.597552755418\t    8.86999999999534\t    463.453479461824\n    413.611017876145\t    954.143388344158\t    8.77000000000407\t    465.071700094375\n    413.604781916778\t    954.542593332134\t    8.60000000000582\t    466.088867474481\n    412.968388225217\t    955.263136106029\t    8.33000000000175\t    466.617120754625\n    412.265886525002\t    956.056052852469\t    8.16999999999825\t    465.747796561181\n    412.910594097915\t     956.79658640007\t    8.02999999999884\t    465.899527268299\n    413.829416419695\t    957.386480451857\t    7.90000000000146\t    466.409925351738\n     414.22415210314\t     958.06341570725\t    7.87000000000262\t    466.955244491812\n      415.1677707968\t    958.716592187518\t    7.52999999999884\t    467.628081344681\n    415.701580225863\t    959.488142422254\t    6.93000000000029\t     467.70256230891\n    416.867407108435\t    960.362493080892\t    6.80000000000291\t    469.134788222928\n    417.610399060359\t    960.783379042937\t    6.69999999999709\t    469.336419672322\n    418.002980476361\t    961.029029939624\t    6.93000000000029\t    470.011666329664\n    417.266680178544\t    961.765709811429\t    6.87000000000262\t    469.647234439539'
canada = np.array(canada_raw.split(), float).reshape(-1, 4)
k = 2
resarch2 = dia.acorr_lm((canada[:, k] - canada[:, k].mean()) ** 2, maxlag=2, autolag=None, store=1)
print(resarch2)
resarch5 = dia.acorr_lm(canada[:, k] ** 2, maxlag=12, autolag=None, store=1)
ss = '        ARCH LM-test; Null hypothesis: no ARCH effects\n\nChi-squared = %(chi)-8.4f df = %(df)-4d p-value = %(pval)8.4g\n'
resarch = resarch5
print()
print(ss % dict(chi=resarch[2], df=resarch[-1].resols.df_model, pval=resarch[3]))
'\n        ARCH LM-test; Null hypothesis: no ARCH effects\n\ndata:  as.vector(Canada[, 3])\nChi-squared = 78.878, df = 5, p-value = 1.443e-15\n'
'\n        ARCH LM-test; Null hypothesis: no ARCH effects\n\nChi-squared = 78.849   df = 5    p-value = 1.461e-15\n'
'\n        ARCH LM-test; Null hypothesis: no ARCH effects\n\ndata:  as.vector(Canada[, 4])\nChi-squared = 74.6028, df = 5, p-value = 1.121e-14\n'
'\n        ARCH LM-test; Null hypothesis: no ARCH effects\n\nChi-squared = 74.6028  df = 5    p-value = 1.126e-14\n'
'\n> ArchTest(as.vector(Canada[,4]), lag=12)\n\n        ARCH LM-test; Null hypothesis: no ARCH effects\n\ndata:  as.vector(Canada[, 4])\nChi-squared = 69.6359, df = 12, p-value = 3.747e-10\n'
'\n        ARCH LM-test; Null hypothesis: no ARCH effects\n\nChi-squared = 69.6359  df = 12   p-value = 3.747e-10\n'